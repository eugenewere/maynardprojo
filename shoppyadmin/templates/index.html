{% extends 'aaa_layout.html' %}
{% load static %}
{% load call_method %}
{% load humanize %}
{% block links %}
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.18/css/dataTables.bootstrap.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/css/bootstrap-select.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>

{#    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.10/css/select2.css">#}
    <link href="https://cdn.jsdelivr.net/npm/select2@4.0.12/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.0.12/dist/js/select2.min.js"></script>
    <style>
    .select2-container{
        width: 100% !important;
    }
    </style>
{% endblock links %}
{% block content %}
	<div class="col-sm-9 col-sm-offset-3 col-lg-10 col-lg-offset-2 main">
		<div class="row">
			<ol class="breadcrumb">
				<li>
					<a href="#">
					<em class="fa fa-home"></em>
				    </a>
			    </li>
				<li class="active">Dashboard</li>
			</ol>
		</div><!--/.row-->
		
		<div class="row">
			<div class="col-lg-12">
				<h1 class="page-header">Dashboard</h1>
			</div>
		</div><!--/.row-->
		
		<div class="panel panel-container ">
            <div class="row">
                {% if  request.user|is_seller %}
                    <a href="{% url 'ShoppyAdmin:shoppy-admin-orders' %}">
                        <div class=" overflow-hidden col-xs-6 col-md-3 col-lg-3 p-5 m-2">
                        <div class="panel-before-custom-a panel dash-panel py-3 panel-orange panel-widget " style="background-color: #FEAA12;">
                             <div class="panel-before-custom">
                                    <em class="fas fa-money-bill-alt color-white"></em>
                             </div>
                            <div style="margin-left: 120px" class=" row no-padding">
                                <em class="fas fa-xl fa-money-bill-alt color-white"></em>

                                {% if sales %}
                                    {%  if sales|floatformat:"0" > 3000000 %}
                                        <div  class="large text-white">{{ sales }}</div>
                                     {% else %}
                                        <div style="font-size: 33px; margin-bottom: 13px;" class="text-white large">{{ sales|floatformat|intcomma }} Ksh</div>
                                    {% endif %}
                                {% else %}
                                     <div class="large" style="">0</div>
                                {% endif %}
                                <div class="text-muted color-white size4 paddingy2">Sales</div>
                            </div>
                        </div>
                    </div></a>
                    <a href="{% url 'ShoppyAdmin:shoppy-admin-orders' %}">
                        <div class=" overflow-hidden  col-xs-6 col-md-3 col-lg-3 p-5 m-2 ">
                        <div class=" panel-before-custom-a panel dash-panel py-3 panel-blue panel-widget  bg-pink">
                            <div class="panel-before-custom ">
                                    <em class="fa fa-xl fa-shopping-cart color-white"></em>
                            </div>
                            <div style="margin-left: 120px" class=" row no-padding">
                                <em class="fa fa-xl fa-shopping-cart color-white"></em>
                                {% if prev_ords %}
                                     {%  if prev_ords.count < 3000000 %}
                                        <div  class="large text-white">{{ prev_ords.count }}</div>
                                     {% else %}
                                        <div style="font-size: 33px; margin-bottom: 13px;" class="large text-white">{{ prev_ords.count }}</div>
                                    {% endif %}
                                {% else %}
                                <div class="large">0</div>
                                {% endif %}
                                <div class="text-muted color-white size4 paddingy2">Completed Orders</div>
                            </div>
                        </div>
                    </div>
                    </a>
                    <a href="{% url 'ShoppyAdmin:shoppy_admin_view_all_products' %}">
                        <div class=" overflow-hidden col-xs-6 col-md-3 col-lg-3 p-5 m-2 ">
                            <div class="panel-before-custom-a panel dash-panel py-3 panel-red panel-widget bg-green">
                                <div class="panel-before-custom">
                                    <em class="fas fa-xl fa-capsules color-white"></em>
                                </div>
                                <div style="margin-left: 120px" class=" row no-padding"><em class="fas fa-xl fa-capsules color-white"></em>
                                    {% if products %}
                                        {%  if products.count > 3000000 %}
                                            <div  class="large text-white">{{ products.count }}</div>
                                         {% else %}
                                            <div style="font-size: 33px; margin-bottom: 13px;" class="large text-white">{{ products.count }}</div>
                                        {% endif %}
                                    {% else %}
                                    <div class="large">0</div>
                                    {% endif %}
                                    <div class="text-muted color-white size4 paddingy2">Products</div>
                                </div>
                            </div>
                        </div>
                    </a>
                    <div class=" overflow-hidden col-xs-6 col-md-3 col-lg-3 p-5 m-2 ">
                        <div class="panel-before-custom-a panel dash-panel py-3 panel-red panel-widget bg-blue">
                            <div class="panel-before-custom">
                                <em class="fas fa-xl fa-truck-loading color-white"></em>
                            </div>
                            <div style="margin-left: 120px" class=" row no-padding"><em class="fas fa-xl fa-truck-loading color-white"></em>
                                {% if ord_count %}
                                    {%  if  ord_count > 3000000 %}
                                        <div  class="large text-white">{{ ord_count }}</div>
                                     {% else %}
                                        <div style="font-size: 33px; margin-bottom: 13px;" class="large text-white">{{  ord_count }}</div>
                                    {% endif %}
                                {% else %}
                                    <div class="large">0</div>
                                {% endif %}
                                <div class="text-muted color-white size4 paddingy2">Pending Orders</div>
                            </div>
                        </div>
                    </div>
                {% endif %}
                {% if not request.user|is_seller %}
                <a href="{% url 'ShoppyAdmin:shoppy-admin-orders' %}">
                    <div class=" overflow-hidden col-xs-6 col-md-3 col-lg-3 p-5 m-2">
					<div class="panel-before-custom-a panel dash-panel py-3 panel-orange panel-widget " style="background-color: #FEAA12;">
                         <div class="panel-before-custom">
                                <em class="fas fa-money-bill-alt color-white"></em>
                         </div>
						<div style="margin-left: 120px" class=" row no-padding">
                            <em class="fas fa-xl fa-money-bill-alt color-white"></em>

							{% if admin_sales %}
                                {%  if admin_sales|floatformat:"0" > 3000000 %}
							        <div  class="large text-white">{{ sales }}</div>
                                 {% else %}
                                    <div style="font-size: 33px; margin-bottom: 13px;" class="text-white large">{{ admin_sales|floatformat|intcomma }} Ksh</div>
                                {% endif %}
                            {% else %}
                                 <div class="large" style="">0</div>
                            {% endif %}
							<div class="text-muted color-white size4 paddingy2">Sales</div>
						</div>
					</div>
				</div></a>
                <a href="{% url 'ShoppyAdmin:shoppy-admin-orders' %}">
				    <div class=" overflow-hidden  col-xs-6 col-md-3 col-lg-3 p-5 m-2 ">
					<div class=" panel-before-custom-a panel dash-panel py-3 panel-blue panel-widget  bg-pink">
                        <div class="panel-before-custom ">
                                <em class="fa fa-xl fa-shopping-cart color-white"></em>
                        </div>
						<div style="margin-left: 120px" class=" row no-padding">
                            <em class="fa fa-xl fa-shopping-cart color-white"></em>
							{% if admin_prev_ords %}
                                 {%  if admin_prev_ords.count < 3000000 %}
							        <div  class="large text-white">{{ admin_prev_ords.count }}</div>
                                 {% else %}
                                    <div style="font-size: 33px; margin-bottom: 13px;" class="large text-white">{{ admin_prev_ords.count }}</div>
                                {% endif %}
                            {% else %}
                            <div class="large">0</div>
                            {% endif %}
							<div class="text-muted color-white size4 paddingy2">Completed Orders</div>
						</div>
					</div>
				</div>
                </a>
                <a href="{% url 'ShoppyAdmin:shoppy-admin-buyers' %}">
                    <div class=" overflow-hidden col-xs-6 col-md-3 col-lg-3 p-5 m-2  ">
                        <div class=" panel-before-custom-a panel dash-panel panel-teal py-3 panel-widget  bg-blue">
                            <div class="panel-before-custom">
                                <em class="fas fa-xl fa-user color-white"></em>
                            </div>
                            <div style="margin-left: 120px" class="  row no-padding"><em class="fas fa-xl fa-user color-white"></em>

                                {% if admin_buyers %}
                                    {%  if admin_buyers.count < 3000000 %}
                                        <div  class="large text-white">{{ admin_buyers.count }}</div>
                                     {% else %}
                                        <div style="font-size: 33px; margin-bottom: 13px;" class="large text-white">{{ admin_buyers.count }}</div>
                                    {% endif %}
                                {% else %}
                                   <div class="large">0</div>
                                {% endif %}
                            <div class="text-muted color-white size4 paddingy2">Buyers</div>
                        </div>
                    </div>
				</div>
                </a>
                <a href="{% url 'ShoppyAdmin:shoppy-admin-sellers' %}">
                    <div class=" overflow-hidden col-xs-6 col-md-3 col-lg-3 p-5 m-2  ">
                        <div class=" panel-before-custom-a panel dash-panel panel-teal py-3 panel-widget " style="background-color: #FEAA12;">
                            <div class="panel-before-custom">
                                <em class="fas fa-xl fa-user color-white"></em>
                            </div>
                            <div style="margin-left: 120px" class="  row no-padding"><em class="fas fa-xl fa-user color-white"></em>

                                {% if admin_sellers %}
                                    {%  if admin_sellers.count < 3000000 %}
                                        <div  class="large text-white">{{ admin_sellers.count }}</div>
                                     {% else %}
                                        <div style="font-size: 33px; margin-bottom: 13px;" class="large text-white">{{ admin_sellers.count }}</div>
                                    {% endif %}
                                {% else %}
                                   <div class="large">0</div>
                                {% endif %}
                            <div class="text-muted color-white size4 paddingy2">Sellers</div>
                        </div>
                    </div>
				</div>
                </a>
            {% endif %}
            </div>
		</div>
{#        barchart#}

        {% if request.user|is_seller %}
        <div class="row">
            <div class="col-lg-6">
                <div class="panel panel-default">
                    <div class="panel-heading panel-warning-custom">
                        Orders
                        <span class="pull-right clickable panel-toggle panel-button-tab-left"><em class="fa fa-toggle-up"></em></span></div>
                    <div class="panel-body">
                        <div class="canvas-wrapper ">
                            <canvas class="main-chart" id="orderschart" height="200" width="600"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="panel panel-default">
                    <div class="panel-heading panel-warning-custom">
                        Orders
                        <span class="pull-right clickable panel-toggle panel-button-tab-left"><em class="fa fa-toggle-up"></em></span></div>
                    <div class="panel-body">
                        <div class="canvas-wrapper ">
                            <canvas class="main-chart" id="orderschartlineseller" height="200" width="600"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}
        {% if not request.user|is_seller %}
                <div class="col-lg-6">
                    <div class="panel panel-default">
                        <div class="panel-heading panel-warning-custom">
                            Users Chart
                            <span class="pull-right clickable panel-toggle panel-button-tab-left"><em class="fa fa-toggle-up"></em></span></div>
                        <div class="panel-body">
                            <div class="canvas-wrapper">
                                <canvas class="main-chart" id="users" height="200" width="600"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="panel panel-default">
                        <div class="panel-heading panel-warning-custom">
                            Orders
                            <span class="pull-right clickable panel-toggle panel-button-tab-left"><em class="fa fa-toggle-up"></em></span>
                        </div>
                        <div class="panel-body">
                            <div class="canvas-wrapper ">
                                <canvas class="main-chart" id="orderschartline" height="200" width="600"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
        {% endif %}



        <div class="row">
            <div class="col-md-12">
				<div class="panel panel-default ">
					<div class="panel-heading  panel-warning-custom">
						Orders
						<span class="pull-right clickable panel-toggle panel-button-tab-left">
                            <em class="fa fa-toggle-up"></em>
                        </span>
                    </div>
                    <div class="panel-body">
                        {% if request.user|is_seller %}
                            {% if buyer_orders|length > 0 %}
                                <div class="main-chart" id="line-chart" style="padding: 10px">
                                   <table id="" class="example table table-striped table-bordered" style="">
                                        <thead>
                                            <tr class="text-capitalize">
                                                <th>#</th>
                                                <th>Buyer</th>
                                                <th>Phone Number</th>
                                                <th>Numbers of Products</th>
                                                <th>Order_number</th>
                                                <th>Region</th>
                                                <th>Address</th>
                                                <th>Total</th>
                                                <th>Created At</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for buyer_order in buyer_orders %}
                                                <tr class="text-center ">
                                                    <td>{{ forloop.counter }}</td>
                                                    <td>{{ buyer_order.buyer.last_name }} {{ buyer_order.buyer.first_name}}</td>
                                                    <td>{{ buyer_order.buyer.phone_number}}</td>
                                                    <td>
                                                        {{ buyer_order.reference_code|seller_buyer_quantities }}
                                                    </td>
                                                    <td>
                                                        {{ buyer_order.reference_code }}

                                                    </td>
                                                    <td>{{ buyer_order.delivery.name }}</td>
                                                    <td>{{ buyer_order.address }}</td>
                                                    <td>
                                                        {{ buyer_order.total|floatformat|intcomma }} Ksh

                                                    </td>
                                                    <td>
                                                        {{ buyer_order.created_at|naturaltime }}
                                                    </td>

                                                    <td>
                                                        <a href="{% url 'ShoppyAdmin:shoppy-buyer_orders' buyer_order.reference_code %}" class="btn btn-success"><i class="fas fa-pencil-alt"></i> View</a>
                                                        <a href="#" data-toggle="modal" data-target="#rd{{ buyer_order.id }}" class="btn btn-danger"><i class="fas fa-trash " style="padding-right: 2px"></i>Cancel Order</a>
                                                    </td>
                                                </tr>
                                            {% endfor %}

                                        </tbody>
                                   </table>
                                </div>
                            {% else %}
                                <div class="row mt-2 d-flex justify-content-center align-content-center align-items-center">
                                     <div class="col-sm-3" style="height: 500px; width: 474px; border: none;margin: 20px; overflow: hidden; text-align: center;">
                                         <h1>No Orders For You</h1>
                                         <img class="img-fluid w-100 h-100" src="{% static 'img/no wishlist image/nowishlist.png' %}" alt="">
                                     </div>
                                </div>
                            {% endif %}
                          {% for buyer_order in buyer_orders %}
                          <!-- Modal -->
                          <div class="modal fade " id="rd{{ buyer_order.id }}" role="dialog">
                            <div class="modal-dialog modal-lg ">
                              <div class="modal-content ">
                                <div class="modal-header">
                                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                                  <h4 class="modal-title">Order Delete Confirmation</h4>
                                </div>
                                <div class="modal-body">
                                  <h4>Are you sure you want to delete <strong>{{ buyer_order.buyer.first_name|title }} {{ buyer_order.buyer.last_name|title }}</strong>  orders</h4>
                                </div>
                                <div class="modal-footer">
                                  <a href="{% url 'ShoppyAdmin:shoppy-buyer_orders_cancel' buyer_order.reference_code %}" class="btn btn-danger"><i class="fas fa-trash"></i> Delete</a>
                                  <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                              </div>
                            </div>
                          </div>
                          {% endfor %}
                        {% endif%}
                        {% if request.user|is_admin %}
                            {% if admin_buyer_orders|length > 0 %}
                                <div class="main-chart" id="line-chart">
                                   <table id="" class="example table table-striped table-bordered" style="">
                                        <thead>
                                            <tr class="text-capitalize">
                                                <th>#</th>
                                                <th>Buyer</th>
                                                <th>Phone Number</th>
                                                <th>Numbers of Products</th>
                                                <th>Order_number</th>
                                                <th>Total</th>
                                                <th>Created At</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for buyer_order in admin_buyer_orders %}
                                                <tr class="text-center ">
                                                    <td>{{ forloop.counter }}</td>
                                                    <td>{{ buyer_order.buyer.last_name }} {{ buyer_order.buyer.first_name}}</td>
                                                    <td>{{ buyer_order.buyer.phone_number}}</td>
                                                    <td>
                                                        {{ buyer_order.reference_code|seller_buyer_quantities }}
                                                    </td>
                                                    <td>
                                                        {{ buyer_order.reference_code }}

                                                    </td>
                                                    <td>
                                                        {{ buyer_order.total|floatformat|intcomma }} Ksh

                                                    </td>
                                                    <td>
                                                        {{ buyer_order.created_at|naturaltime }}
                                                    </td>

                                                    <td>
                                                        <a href="{% url 'ShoppyAdmin:shoppy-buyer_orders' buyer_order.reference_code %}" class="btn btn-success"><i class="fas fa-pencil-alt"></i> View</a>
                                                    </td>
                                                </tr>
                                            {% endfor %}

                                        </tbody>
                                    </table>
                                </div>
                            {% else %}
                                <div class="row mt-2 d-flex justify-content-center align-content-center align-items-center">
                                     <div class="col-sm-3" style="height: 500px; width: 474px; border: none;margin: 20px; overflow: hidden; text-align: center;">
                                         <h1>No Orders For You</h1>
                                         <img class="img-fluid w-100 h-100" src="{% static 'img/no wishlist image/nowishlist.png' %}" alt="">
                                     </div>
                                </div>
                            {% endif %}
                        {% endif %}
					</div>
				</div>
			</div><!--/.col-->
        </div>
        {% if  request.user|is_seller %}
            {% if out_of_stock_products %}
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-default ">
                            <div class="panel-heading  panel-warning-custom">
                                Unavailable Products
                                <span class="pull-right clickable panel-toggle panel-button-tab-left">
                                    <em class="fa fa-toggle-up"></em>
                                </span>
                            </div>
                            <div class="panel-body">
                               <table id="example" class="table table-striped table-bordered" style="width:100%;">
                                    <thead>
                                        <tr class="text-capitalize">
                                            <th>Id</th>
                                            <th>Picture</th>
                                            <th>Name</th>
                                            <th>Brand</th>
                                            <th>Price(Kshs)</th>
                                            <th>Status</th>
                                            {% if not request.user|is_seller %}
                                            <th>Seller</th>
                                            {% endif %}
                                            <th>Created At</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for product in out_of_stock_products %}
                                        <tr class="text-center ">
                                            <td class="tb-data">{{ forloop.counter }}</td>
                                            <td class="tb-data tb-data" style="width: 110px; position: relative">
                                                <div class="product-image ">
                                                   <img src="{{ product.featured_url.url }}" alt="{{ product.name }}">
                                                </div>

                                                {% if product.id|product_on_offer %}
                                                    {% for offer in product.id|product_on_offer %}
                                                        <span class="badge-custom-admin">
                                                            Offer {{ offer.offer_percentage }}%
                                                        </span>
                                                    {% endfor %}
                                                {% endif %}
                                            </td>
                                            <td class="product-details" style="width: 299px; text-transform: uppercase;">{{ product.name }}</td>
                                            <td class="tb-data">{{ product.product_brand }}</td>
                                            <td class="tb-data ">
                                                {% if  product.price_after_offer and product.id|product_on_offer %}
                                                    <div style="display: flex;flex-direction: column;">
                                                        <span> {{ product.price_after_offer|floatformat:1|intcomma }}Kshs</span>
                                                        <span class="striked-price">{{ product.unit_cost_inclusive_of_vat|floatformat:1|intcomma }} Kshs</span>
                                                    </div>
                                                {% else %}
                                                    <span> {{ product.unit_cost|floatformat:1|intcomma }}Kshs</span>
                                                {% endif %}
                                            </td>
                                            <td class="tb-data">{{ product.status }}</td>
                                            {% if not request.user|is_seller %}
                                                <td class="tb-data">{{ product.seller }}</td>
                                            {% endif %}
                                            <td class="tb-data">{{ product.link_inventories.updated_at|naturaltime }}</td>
                                            <td style=" width:302px" class="text-center tb-data">


                                                <a href="#" data-toggle="modal" data-target="#ff{{ product.id }}" class="btn btn-danger"><i class="fas fa-trash-alt"></i> Delete</a>
                                                <a data-toggle="modal" data-target="#ofsp{{ product.id }}" href="#" class="btn btn-success"><i class="fas fa-pencil-alt"></i> Edit Inventory</a>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                               </table>
                                {%  for product in out_of_stock_products %}

                                    <!-- Modal -->
                                    <div class="modal fade" id="ofsp{{ product.id }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                                      <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                          <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                            <h4 class="modal-title" id="myModalLabel">Product Inventory -> ({{ product.name|title }})</h4>
                                          </div>
                                            <form action="{% url 'ShoppyAdmin:updateInventory' product.id %}" method="post">
                                                {% csrf_token %}
                                              <div class="modal-body" style="height: 200px; padding: 59px 19px;">
                                                  <div class="input-group">
                                                      <label for="kkks{{ product.id }}">Product Inventory -> ({{ product.name|title }})</label>
                                                      <input value="{{ product.prod_inventory.quantity }}" id="kkks{{ product.id }}" type="number" name="inventory" class="form-control" placeholder="Inventory" aria-describedby="basic-addon1">
                                                  </div>
                                              </div>
                                              <div class="modal-footer">
{#                                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>#}
                                                  <button type="submit" class="btn btn-success">Save changes</button>
                                              </div>
                                            </form>

                                        </div>
                                      </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div><!--/.col-->
                </div>
            {% endif %}
        {% endif %}





         {% if  request.user|is_seller %}
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading panel-warning-custom">
                            Reports
                            <span class="pull-right clickable panel-toggle panel-button-tab-left"><em class="fa fa-toggle-up"></em></span>
                        </div>
                        <div class="panel-body">
                          <div class="canvas-wrapper">
                                <div class="main-chart" id="line-chart" >
                                    <div class="col-sm-12">

                                        <div class="row">
                                            <div class="col-sm-6">
                                                <form action="{% url 'ShoppyAdmin:export_users_xl_date' %}" method="POST">
                                                {% csrf_token %}
                                                    <div class="col">
                                                        <h3>Filter By Date</h3>
                                                    </div>

                                                    <div class="col-sm-12 col-md-6">
                                                         <label for="d1"> Date From</label>
                                                         <input name="datefrom" required id="d1" type="date" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm">
                                                    </div>
                                                    <div class="col-sm-12 col-md-6">
                                                         <label for="d2">Date TO</label>
                                                         <input name="dateto" required id="d2" type="date" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm">
                                                    </div>
                                                    <div class="col " style="padding: 20px 30px;">
                                                        <button style="margin-top: 20px;" class="btn btn-success" type="submit">Filter</button>
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="col-sm-6">
                                                <form action="{% url 'ShoppyAdmin:export_users_xl' %}" method="POST">
                                                {% csrf_token %}
                                                    <div class="col">
                                                        <h3>Filter By Buyer</h3>
                                                    </div>
                                                    <div class="col">
                                                        <div class="form-group ">
                                                          <label class="control-label" for="buyerz">Buyer</label><br>
                                                          <select required  style="width: 100%;height: 40px;" id="buyerz" name="buyer"  class="w-100" >
                                                              <option disabled>Choose A Buyer</option>
                                                              {% for buyer in history_buyers_with_orders %}
                                                                 <option value="{{ buyer.id }}">{{ buyer.first_name }} {{ buyer.last_name }} </option>
                                                              {% endfor %}
                                                          </select>
                                                            <script>
                                                                $(document).ready(function() {
                                                                    $("#buyerz").select2();
                                                                });
                                                            </script>
                                                        </div>
                                                    </div>

                                                    <div class="col-sm-12 col-md-6">
                                                         <label for="d1"> Date From</label>
                                                         <input name="datefrom" required id="d1" type="date" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm">
                                                    </div>
                                                    <div class="col-sm-12 col-md-6">
                                                         <label for="d2">Date TO</label>
                                                         <input name="dateto" required id="d2" type="date" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm">
                                                    </div>
                                                    <div class="col " style="padding: 20px 30px;">
                                                        <button style="margin-top: 20px;" class="btn btn-success" type="submit">Filter</button>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>

                                        <div class="row p-3" >
                                            <a href="{%  url 'ShoppyAdmin:export_users_xl' %}">
                                                <div class="report_wrapper col-sm-4 col-xs-12">
                                                    <div class="pdfImage">
                                                        <img src="{% static 'images/siteimages/reportspdf.png' %}" alt="">
                                                    </div>
                                                    <div class="report_subject">
                                                        <h3 class="text-capitalize">Export Orders To Excel (Excel)</h3>
                                                    </div>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div><!--/.row-->
         {% endif %}
	</div>	<!--/.main-->

	
{% endblock %}
{% block scripts %}

{#    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/js/bootstrap-select.min.js"></script>#}
    <script>
        ClassicEditor
            .create( document.querySelector( '#ckeditor' ) )
            .catch( error => {
                console.error( error );
        } );
    </script>
    <script>
        $(document).ready(function() {
            $('#example').DataTable();
        } );
    </script>
    <script>
        $(document).ready(function() {
            $('.example').DataTable();
        } );
    </script>
    <script>
        $(function() {
          $('.selectpicker').selectpicker();
        });
    </script>

    <script >
        var endpoint = '{% url 'ShoppyAdmin:users_chart' %}';
        var defaultData =  [];
        var labels = [];
        $.ajax({
            method: "GET",
            url : endpoint,
            success : function (data) {
                var labels = data.labels;
                var seller= data.defaultData2;
                var buyer= data.defaultData;

                var ctx = document.getElementById('users').getContext('2d');
                    var myChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Buyer',
                                data: buyer,
                                backgroundColor:'rgb(254,170,18)',
                                borderColor: [
                                    'rgb(255,219,0)',
                                    'rgb(212,0,235)',

                                ],
                                borderWidth: 1
                            },
                            {
                                label: 'Seller',
                                data: seller,
                                backgroundColor:'rgb(36,49,68)',
                                borderColor: [
                                    'rgb(255,219,0)',
                                    'rgb(212,0,235)',

                                ],
                                borderWidth: 1
                            },


                        ],
                    },

                    options: {
                        scales: {
                            yAxes: [{
                                ticks: {
                                    beginAtZero: true
                                }
                            }]
                        },
                        tooltips:{
                            enabled:true,
                        }
                    }
                });

                    },
                    error : function (error_data) {
                        console.log(error);
                        console.log(error_data);
                    },
                });



        var endpoint2 = '{% url 'ShoppyAdmin:orders_chart' %}';
        var defaultData2 =  [];
        var labels2 = [];
        $.ajax({
            method: "GET",
            url : endpoint2,
            success : function (data) {
                labels2 = data.labels2;
                defaultData23= data.defaultData23;
                setOrderChart();
                setOrderChartlineseller();

                // console.log(data);
            },
            error : function (error_data) {
                console.log(error);
                console.log(error_data);
            },
        });

        function setOrderChart() {
            var ctx = document.getElementById('orderschart').getContext('2d');
            var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels2,
                datasets: [{
                    label: 'Orders',

                    data: defaultData23,
                    backgroundColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgb(129,255,46)',
                        'rgb(255,217,66)',
                        'rgb(255,131,255)',
                        'rgb(1,53,255)',
                        'rgba(255, 159, 64, 1)',
                        'rgb(36,255,221)',
                        'rgb(145,255,39)',
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgb(129,255,46)',
                        'rgb(255,217,66)',
                        'rgb(255,131,255)',
                        'rgb(1,53,255)',
                        'rgba(255, 159, 64, 1)',
                        'rgb(36,255,221)',
                        'rgb(145,255,39)',

                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {


                            stepSize: 1,
                            beginAtZero: true
                        }
                    }]
                }
            }
        });
        }

        function setOrderChartlineseller(){
            var ctx = document.getElementById('orderschartlineseller').getContext('2d');
            var myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels2,
                datasets: [{
                    label: 'Orders',

                    data: defaultData23,
                    backgroundColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgb(129,255,46)',
                        'rgb(255,217,66)',
                        'rgb(255,131,255)',
                        'rgb(1,53,255)',
                        'rgba(255, 159, 64, 1)',
                        'rgb(36,255,221)',
                        'rgb(145,255,39)',

                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgb(129,255,46)',
                        'rgb(255,217,66)',
                        'rgb(255,131,255)',
                        'rgb(1,53,255)',
                        'rgba(255, 159, 64, 1)',
                        'rgb(36,255,221)',
                        'rgb(145,255,39)',

                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {


                            stepSize: 1,
                            beginAtZero: true
                        }
                    }]
                }
            }
        });
        }


        var endpoint2 = '{% url 'ShoppyAdmin:orders_chartadmin' %}';
        var defaultData2 =  [];
        var labels2 = [];
        $.ajax({
            method: "GET",
            url : endpoint2,
            success : function (data) {
                labels3 = data.labels3;
                defaultData3= data.defaultData3;

                setOrderChartline();
                // console.log(data);
            },
            error : function (error_data) {
                console.log(error);
                console.log(error_data);
            },
        });
        function setOrderChartline() {
            var ctx = document.getElementById('orderschartline').getContext('2d');
            var myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels3,
                datasets: [{
                    label: 'Orders',
                    data: defaultData3,
                    backgroundColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgb(129,255,46)',
                        'rgb(255,217,66)',
                        'rgb(255,131,255)',
                        'rgb(1,53,255)',
                        'rgba(255, 159, 64, 1)',
                        'rgb(36,255,221)',
                        'rgb(145,255,39)',

                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgb(129,255,46)',
                        'rgb(255,217,66)',
                        'rgb(255,131,255)',
                        'rgb(1,53,255)',
                        'rgba(255, 159, 64, 1)',
                        'rgb(36,255,221)',
                        'rgb(145,255,39)',

                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            stepSize: 1,
                            beginAtZero: true
                        }
                    }]
                }
            }
        });
        }

    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.18/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.18/js/dataTables.bootstrap.min.js"></script>

{% endblock scripts %}